"use strict";(function(b){function a(){this.cb_Parallax=Cb_Parallax_Admin;this.attachmentWidth=this.cb_Parallax.image_data.image_width!=="undefined"?this.cb_Parallax.image_data.image_width:0;this.attachmentHeight=this.cb_Parallax.image_data.image_height!=="undefined"?this.cb_Parallax.image_data.image_height:0;this.parallaxEnabledSwitch=null;this.placeholderImage=null;this.backgroundImage=null;this.attachmentId=null;this.CheckBoxes=null;this.parallaxDirectionSelectBox=null;this.addMediaButton=null;this.removeMediaButton=null;this.settingsForm=null;this.submitButton=null;this.resetButton=null;this.allImageOptions=null;this.staticImageOptions=null;this.parallaxImageOptions=null;this.verticalScrollDirectionContainer=null;this.horizontalScrollDirectionContainer=null;this.verticalAlignmentContainer=null;this.horizontalAlignmentContainer=null}a.prototype={constructor:a,init:function(){this.setObjects();this.localizeScript();this.assembleContainers();this.initColorpicker();this.initFancySelect();this.setView();this.bind()},setObjects:function(){this.parallaxEnabledSwitch=b(".cb_parallax_parallax_enabled");this.placeholderImage=b(".cb_parallax_placeholder_image");this.backgroundImage=b(".cb_parallax_background_image");this.attachmentId=b(".cb_parallax_attachment_id");this.CheckBoxes=b(".cb-parallax-input-checkbox");this.parallaxDirectionSelectBox=b("[data-key='cb_parallax_direction']");this.parallaxSettingsTitle=b("h3.parallax");this.staticSettingsTitle=b("h3.static");this.addMediaButton=b(".cb-parallax-media-url");this.removeMediaButton=b(".cb-parallax-remove-media");this.settingsForm=b("#cb_parallax_settings_form");this.submitButton=b("#cb_parallax_form_submit");this.resetButton=b("#cb_parallax_form_reset");this.direction=undefined!==this.cb_Parallax.image_options.cb_parallax_direction?this.cb_Parallax.image_options.cb_parallax_direction:this.cb_Parallax.default_options.cb_parallax_direction},assembleContainers:function(){this.allImageOptions=b("#cb_parallax_parallax_enabled_container, #cb_parallax_background_color_container, #cb_parallax_direction_container, #cb_parallax_vertical_scroll_direction_container, #cb_parallax_horizontal_scroll_direction_container, #cb_parallax_horizontal_alignment_container, #cb_parallax_vertical_alignment_container, #cb_parallax_overlay_image_container, #cb_parallax_overlay_opacity_container, #cb_parallax_overlay_color_container, #cb_parallax_background_repeat_container, #cb_parallax_position_x_container, #cb_parallax_position_y_container, #cb_parallax_background_attachment_container");this.parallaxImageOptions=b("#cb_parallax_parallax_enabled_container, #cb_parallax_background_color_container, #cb_parallax_direction_container, #cb_parallax_vertical_scroll_direction_container, #cb_parallax_horizontal_scroll_direction_container, #cb_parallax_horizontal_alignment_container, #cb_parallax_vertical_alignment_container, #cb_parallax_overlay_image_container, #cb_parallax_overlay_opacity_container, #cb_parallax_overlay_color_container");this.staticImageOptions=b("#cb_parallax_parallax_enabled_container, #cb_parallax_background_color_container, #cb_parallax_background_repeat_container, #cb_parallax_position_x_container, #cb_parallax_position_y_container, #cb_parallax_background_attachment_container, #cb_parallax_overlay_image_container, #cb_parallax_overlay_opacity_container, #cb_parallax_overlay_color_container");this.verticalScrollDirectionContainer=b("#cb_parallax_vertical_scroll_direction_container");this.horizontalScrollDirectionContainer=b("#cb_parallax_horizontal_scroll_direction_container");this.verticalAlignmentContainer=b("#cb_parallax_vertical_alignment_container");this.horizontalAlignmentContainer=b("#cb_parallax_horizontal_alignment_container")},initColorpicker:function(){b(".cb-parallax-color-picker").wpColorPicker()},initFancySelect:function(){b(".cb-parallax-fancy-select").fancySelect()},localizeScript:function(){b('<style>.cb-parallax-switch-input ~ .cb-parallax-switch-label:before{content:"'+this.cb_Parallax.strings.switches_text.Off+'";}</style>').appendTo("head");b('<style>.cb-parallax-switch-input:checked ~ .cb-parallax-switch-label:after{content:"'+this.cb_Parallax.strings.switches_text.On+'";}</style>').appendTo("head")},bind:function(){this.CheckBoxes.bind("click",this.toggleCheckbox);this.parallaxEnabledSwitch.bind("change",{context:this},this.toggleParallaxDirection);this.parallaxEnabledSwitch.bind("change",{context:this},this.setView);this.parallaxDirectionSelectBox.bind("change.fs",{context:this},this.toggleParallaxDirection);this.removeMediaButton.bind("click",{context:this},this.removeMedia);this.addMediaButton.bind("click",{context:this},this.addMedia);this.submitButton.bind("click",{context:this},this.cbparallaxSaveOptions);this.resetButton.bind("click",{context:this},this.cbparallaxResetOptions)},setView:function(c){var d=this;if(undefined!==c){c.preventDefault();d=c.data.context}d.allImageOptions.hide();d.removeMediaButton.hide();if(d.backgroundImage.attr("src")!==""){d.removeMediaButton.show();if(d.attachmentWidth<1920||d.attachmentHeight<1200){d.parallaxImageOptions.hide();d.staticImageOptions.show()}else{if((d.attachmentWidth>=1920&&d.attachmentHeight>=1200)&&"0"===d.parallaxEnabledSwitch.val()){d.parallaxImageOptions.hide();d.staticImageOptions.show()}else{if(d.attachmentWidth>=1920&&d.attachmentHeight>=1200&&"1"===d.parallaxEnabledSwitch.val()){d.staticImageOptions.hide();d.parallaxImageOptions.show()}}}}d.toggleParallaxEnabledCheckbox()},toggleParallaxDirection:function( c){if(undefined!==c){c.preventDefault();var d =c.data.context}else{d =this}d.parallaxSettingsTitle.addClass("hidden");d.staticSettingsTitle.addClass("hidden");d.parallaxDirectionSelectBox.trigger("change.$");if(d.parallaxEnabledSwitch.prop("checked")){d.parallaxSettingsTitle.removeClass("hidden");if(d.backgroundImage.attr("src")!==""){if(d.parallaxDirectionSelectBox.val()===d.direction){d.horizontalScrollDirectionContainer.hide();d.verticalAlignmentContainer.hide();d.verticalScrollDirectionContainer.show();d.horizontalAlignmentContainer.show()}else{d.verticalScrollDirectionContainer.hide();d.horizontalAlignmentContainer.hide();d.horizontalScrollDirectionContainer.show();d.verticalAlignmentContainer.show()}}else{d.verticalScrollDirectionContainer.hide();d.horizontalAlignmentContainer.hide();d.horizontalScrollDirectionContainer.hide();d.verticalAlignmentContainer.hide()}}else{d.verticalScrollDirectionContainer.hide();d.horizontalAlignmentContainer.hide();d.horizontalScrollDirectionContainer.hide();d.verticalAlignmentContainer.hide();d.staticSettingsTitle.removeClass("hidden")}},toggleCheckbox:function(){if("0"===b(this).val()){b(this).val("1")}else{b(this).val("0")}},addMedia:function(c){c.preventDefault();var d=c.data.context;if(d.backgroundImage.attr("src")!==""){}if(e){e.open();return}var e=wp.media.frames.cb_parallax_frame=wp.media({className:"media-frame cb-parallax-frame",frame:"select",multiple:false,title:cbParallaxMediaFrame.title,library:{type:"image"},button:{text:cbParallaxMediaFrame.button}});e.on("select",function(){var f=e.state().get("selection").first().toJSON();d.attachmentId.val(f.id);d.backgroundImage.attr("src",f.url);d.placeholderImage.hide();b("[data-key='cb_parallax_background_image_url_hidden']").val(f.url);b("[data-key='cb_parallax_attachment_id']").val(f.id);d.addMediaButton.addClass("disabled");d.attachmentHeight=f.height;d.attachmentWidth=f.width;d.setView()});e.open()},removeMedia:function(c){c.preventDefault();var d=c.data.context;d.backgroundImage.attr("src","");d.placeholderImage.show();d.attachmentId.val("");d.attachmentHeight=0;d.attachmentWidth=0;b("[data-key='cb_parallax_background_image_url_hidden']").val("");b("[data-key='cb_parallax_attachment_id']").val("");d.addMediaButton.removeClass("disabled");d.setView();return false},cbparallaxSaveOptions:function(e){e.preventDefault();var h=e.data.context;var c={};var d=h.settingsForm.data("form");var g="image"===d?h.cb_Parallax.option_keys.image:h.cb_Parallax.option_keys.all;b.each(g,function(){c[this]=b("[data-key='"+this+"']").val()});var f={action:"cb_parallax_save_options",nonce:h.settingsForm.data("nonce"),input:c,post_id:h.settingsForm.data("postid")};b.post(ajaxurl,f,function(i){if(i.success===true){alert(h.cb_Parallax.strings.save_options_ok)}else{alert(h.cb_Parallax.strings.save_options_error)}});h.setView();return false},cbparallaxResetOptions:function(c){c.preventDefault();var e=c.data.context;var d={action:"cb_parallax_reset_options",nonce:e.settingsForm.data("nonce"),post_id:e.settingsForm.data("postid")};b.post(ajaxurl,d,function(f){if(f.success===true){e.resetOptionsPageInputFields();b("");alert(e.cb_Parallax.strings.reset_options_ok)}else{alert(e.cb_Parallax.strings.reset_options_error)}});e.resetOptionsPageInputFields()},resetOptionsPageInputFields:function(){var c=this.settingsForm.data("form");var d="image"===c?$this.cb_Parallax.option_keys.image:$this.cb_Parallax.option_keys.all;b.each(d,function(){var f=b("[data-key="+this+"]");var h=$this.cb_Parallax.default_options[this];if("checkbox"===f.attr("type")){b(f).val("0").prop("checked","")}else{if("text"===f.attr("type")){b(f).wpColorPicker("color","transparent")}else{if("select"===f.attr("type")){f.val(h);var g=b(f).parent().find("ul.options");var e=b(g).find("li");b(e).removeAttr("class");b(g).find(b("li[data-raw-value="+this+"]")).addClass("selected");b(f).parent().find(".trigger").html(h)}else{b(f).val(h)}}}});this.backgroundImage.attr("src","");this.placeholderImage.show();b("[data-key='cb_parallax_background_image_url_hidden']").val("");b("[data-key='cb_parallax_attachment_id']").val("")}};b(document).one("ready",function(){var c=new a();c.init()})})(jQuery);
